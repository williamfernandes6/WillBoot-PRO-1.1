<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA ELITE PRO - LUANDA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Inter:wght@400;700;900&display=swap');
        body { background: #050507; color: #fff; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        .font-orbitron { font-family: 'Orbitron', sans-serif; }
        .glass { background: rgba(18, 18, 22, 0.95); border: 1px solid rgba(255, 255, 255, 0.05); }
        .neon-pink { border: 1px solid rgba(219, 39, 119, 0.4); box-shadow: 0 0 25px rgba(219, 39, 119, 0.1); }
        .chip { font-size: 11px; padding: 4px 10px; border-radius: 6px; font-weight: 900; }
        @keyframes pulse-red { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
        .animate-blink { animation: pulse-red 1s infinite; }
    </style>
</head>
<body class="flex flex-col items-center p-4 min-h-screen lg:justify-center">

    <div class="fixed top-4 right-4 flex items-center gap-2 glass px-3 py-1 rounded-full text-[9px] font-bold">
        <span>RENDER STATUS:</span>
        <div id="render-led" class="w-2 h-2 rounded-full bg-red-600 animate-blink"></div>
    </div>

    <div class="w-full max-w-md lg:max-w-4xl lg:grid lg:grid-cols-2 lg:gap-8">
        <div class="space-y-4">
            <div class="flex justify-between items-center glass p-5 rounded-3xl">
                <div><p class="text-[9px] text-pink-600 font-black uppercase">Luanda Time</p><p id="clock" class="text-xl font-orbitron">00:00:00</p></div>
                <div class="text-right"><p class="text-[9px] text-zinc-500 font-black uppercase">Banca Kz</p><p id="banca" class="text-xl font-bold text-green-500">---</p></div>
            </div>
            <div class="glass p-4 rounded-2xl flex justify-between items-center border-l-4" id="tendencia-box" style="border-left-color: #52525b;">
                <div><p class="text-[10px] text-zinc-500 font-bold uppercase">Tendência Provedor</p><p id="tendencia-txt" class="text-lg font-black italic">ANALISANDO...</p></div>
                <div id="tendencia-led" class="w-3 h-3 rounded-full"></div>
            </div>
            <div class="neon-pink bg-zinc-900/90 p-8 rounded-[40px] text-center relative">
                <div id="status" class="text-[10px] font-black uppercase tracking-[0.3em] text-zinc-500 mb-2">IA Sistema Pronta</div>
                <div id="timer" class="text-6xl font-orbitron mb-8 tracking-tighter text-white">--:--</div>
                <div class="flex justify-between items-center mb-6 px-2 text-left"><p class="text-[9px] text-zinc-400 font-black uppercase animate-blink">Angola (GMT+1)</p></div>
                <div class="grid grid-cols-2 gap-4 mb-8 py-5 border-y border-zinc-800">
                    <div class="text-left"><p class="text-[9px] text-zinc-500 uppercase font-black mb-1">Assertividade</p><p id="pct" class="text-2xl font-black text-pink-500">0%</p></div>
                    <div class="text-right"><p class="text-[9px] text-zinc-500 uppercase font-black mb-1">Alvo IA</p><p id="alvo" class="text-xl font-black text-white italic">---</p></div>
                </div>
                <input type="file" id="file" class="hidden" accept="image/*">
                <button onclick="document.getElementById('file').click()" class="w-full bg-zinc-800 py-4 rounded-2xl mb-3 text-[11px] font-bold uppercase">1. Carregar Print</button>
                <button onclick="analisar()" class="w-full bg-pink-600 py-5 rounded-2xl text-xl font-black shadow-xl active:scale-95 transition-all">2. Gerar Previsão</button>
            </div>
        </div>
        <div class="space-y-4 mt-4 lg:mt-0">
            <div class="glass p-6 rounded-3xl text-center">
                <p class="text-[10px] font-black text-zinc-400 uppercase mb-4">Sinal Assertivo?</p>
                <div class="grid grid-cols-2 gap-4">
                    <button onclick="feedback('CERTO')" class="bg-green-600/20 border border-green-600 text-green-500 py-3 rounded-xl font-bold hover:bg-green-600 transition-all">SINAL CERTO ✅</button>
                    <button onclick="feedback('ERRADO')" class="bg-red-600/20 border border-red-600 text-red-500 py-3 rounded-xl font-bold hover:bg-red-600 transition-all">SINAL ERRADO ❌</button>
                </div>
            </div>
            <div class="glass p-5 rounded-3xl h-full"><p class="text-[9px] text-zinc-500 font-black mb-4 uppercase tracking-widest text-center">Histórico Analisado</p><div id="hist" class="flex flex-wrap gap-2 justify-center"></div></div>
        </div>
    </div>

    <script>
        const API_URL = 'https://ia-boot-elite-backend-qs3x.onrender.com';
        async function checkStatus() {
            const led = document.getElementById('render-led');
            try { const r = await fetch(`${API_URL}/ping`); if(r.ok) { led.className = 'w-2 h-2 rounded-full bg-green-500'; } } 
            catch(e) { led.className = 'w-2 h-2 rounded-full bg-red-600 animate-blink'; }
        }
        setInterval(checkStatus, 5000);
        setInterval(() => {
            const opt = { timeZone: 'Africa/Luanda', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            document.getElementById('clock').innerText = new Intl.DateTimeFormat('pt-PT', opt).format(new Date());
        }, 1000);

        async function analisar() {
            const file = document.getElementById('file').files[0];
            if (!file) return alert("Selecione a imagem!");
            document.getElementById('status').innerText = "PROCESSANDO...";
            const formData = new FormData(); formData.append('print', file);
            try {
                const response = await fetch(`${API_URL}/analisar-fluxo`, { method: 'POST', body: formData });
                const data = await response.json();
                document.getElementById('tendencia-txt').innerText = data.tendencia;
                document.getElementById('tendencia-txt').style.color = data.corTendencia;
                document.getElementById('tendencia-led').style.background = data.corTendencia;
                document.getElementById('tendencia-box').style.borderLeftColor = data.corTendencia;
                const t = data.timerRosa.split(':'); document.getElementById('timer').innerText = t[0]+":"+t[1];
                document.getElementById('pct').innerText = data.pct;
                document.getElementById('banca').innerText = data.banca;
                document.getElementById('alvo').innerText = data.alvo;
                document.getElementById('status').innerText = data.status;
                document.getElementById('status').style.color = data.cor;
                const histDiv = document.getElementById('hist'); histDiv.innerHTML = '';
                data.historico.forEach(v => {
                    const chip = document.createElement('div');
                    let c = v < 2 ? 'bg-blue-600' : (v < 10 ? 'bg-purple-600' : 'bg-pink-600');
                    chip.className = `chip ${c}`; chip.innerText = v.toFixed(2) + 'x';
                    histDiv.appendChild(chip);
                });
            } catch (error) { alert("Render a despertar..."); }
        }
        async function feedback(tipo) {
            const data = { status: tipo, hora: new Date().toLocaleTimeString("pt-PT", {timeZone: "Africa/Luanda"}), dia: new Date().toLocaleDateString(), alvo: document.getElementById('alvo').innerText };
            await fetch(`${API_URL}/feedback`, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data) });
            alert("Aprendizado registado!");
        }
    </script>
</body>
</html>
